/* Settings Modal Styles
=========================================================
This file contains styles specific to the settings modal interface 
for the MagicPrompt extension. It defines the layout, components, 
and interactive elements of the settings UI.

TABLE OF CONTENTS:
1. Modal Core Structure
2. Settings Sections
3. Form Controls
4. Button Styles
5. Expandable Sections
6. Instruction UI
7. Feature Associations
8. Custom Instruction Management
9. Custom Instruction Modal
10. Tabbed Interface for Instructions
=========================================================== */

/* 1. MODAL CORE STRUCTURE
   Base styles for the modal dialog */

#settingsModal {
    /* Base modal styles */
    --modal-width: 800px;
    --section-padding: 1.5rem;
    --border-style: 1px solid var(--border-color);
}

    #settingsModal .modal-dialog {
        width: var(--modal-width);
        max-width: var(--modal-width);
        min-width: var(--modal-width);
        margin: 1.75rem auto;
    }

    #settingsModal .modal-content {
        width: 100%;
        min-height: 600px;
        background: var(--background);
        border: var(--border-style);
        border-radius: 8px;
    }

    /* 2. SETTINGS SECTIONS 
   Content areas and containers */

    #settingsModal .modal-body {
        padding: var(--section-padding);
        min-height: 450px;
    }

    #settingsModal .settings-container,
    #settingsModal .settings-card,
    #settingsModal .settings-grid {
        width: 100%;
    }

    #settingsModal .settings-card {
        margin-bottom: 1rem;
        border: var(--border-style);
        border-radius: 4px;
        background: var(--background-gray);
    }

    /* 3. SECTION HEADERS 
   Headers and toggles for sections */

    #settingsModal .settings-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.75rem;
        cursor: pointer;
    }

        #settingsModal .settings-header .d-flex {
            display: flex;
            align-items: center;
            padding: 0;
            margin: 0;
        }

    #settingsModal .settings-header-icon {
        font-size: 1em;
        margin-right: 0.5rem;
        display: flex;
        align-items: center;
    }

    #settingsModal .settings-section-title {
        margin: 0;
        font-size: 0.95em;
        font-weight: 600;
        color: var(--text);
    }

    /* Add Custom button in header */
    #settingsModal #addCustomInstructionBtn {
        border: 1px solid var(--emphasis);
        background-color: var(--emphasis);
        color: var(--button-foreground-hover);
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
        border-radius: 4px;
        margin-right: 0.5rem;
        cursor: pointer;
        transition: all 0.2s;
    }

        #settingsModal #addCustomInstructionBtn:hover {
            opacity: 0.9;
        }

    /* 4. COLLAPSE CONTROLS
   Expand/collapse section toggles */

    #settingsModal .collapse-toggle {
        --toggle-size: 24px;
        background: none;
        border: none;
        color: inherit;
        font-size: 0.8em;
        padding: 0.25rem;
        transition: transform 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        width: var(--toggle-size);
        height: var(--toggle-size);
    }

        #settingsModal .collapse-toggle[aria-expanded="true"] {
            transform: rotate(180deg);
        }

    #settingsModal .collapse {
        padding: 0.75rem;
        background: var(--background);
        border-top: var(--border-style);
        border-radius: 0 0 4px 4px;
    }

    /* 5. FORM CONTROLS
   Input fields, selects, radios */

    #settingsModal .form-group {
        margin-bottom: 1rem;
    }

    #settingsModal .form-label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--text);
    }

    #settingsModal .form-control,
    #settingsModal .form-select,
    #settingsModal .btn-outline-primary {
        padding: 0.5rem;
        border: var(--border-style);
        border-radius: 4px;
        background: var(--background);
        color: var(--text);
    }

    #settingsModal .form-control,
    #settingsModal .form-select {
        width: 100%;
    }

    /* Radio buttons */
    #settingsModal .btn-check + .btn-outline-primary {
        /* Unselected state */
        border: 1px solid var(--shadow);
        background: var(--shadow);
        color: var(--emphasis-text);
        padding: 0.25rem 0.5rem;
    }

    #settingsModal .btn-check:checked + .btn-outline-primary {
        /* Selected state */
        background: var(--emphasis);
        border-color: var(--emphasis);
        color: var(--button-foreground-hover);
    }

    #settingsModal .btn-check + .btn-outline-primary:hover {
        background: color-mix(in srgb, var(--emphasis-soft) 70%, white);
        color: var(--emphasis-text);
    }

    /* 6. INSTRUCTION UI
   Specific styles for instruction type radio buttons */

    #settingsModal #instructionTypeGroup {
        margin-bottom: 1rem;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        width: 100%;
    }

        #settingsModal #instructionTypeGroup .btn-outline-primary {
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            margin: 0;
            width: auto;
            flex: 0 0 auto;
        }

    #settingsModal #instructionTextarea {
        min-height: 450px;
        resize: vertical;
    }

    #settingsModal .instruction-type-label {
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }

    /* 7. FEATURE ASSOCIATIONS
   Styles for feature-to-instruction mapping */

    #settingsModal #featureAssociationsCollapse .form-select {
        margin-bottom: 0.25rem;
    }

    /* 8. CUSTOM INSTRUCTION MANAGEMENT
   Styles for the instruction management section */

    #settingsModal .position-relative {
        position: relative;
    }

    #settingsModal .import-input {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
        z-index: 1;
    }

    #settingsModal .custom-instructions-list {
        margin-top: 1rem;
        border: var(--border-style);
        border-radius: 4px;
        max-height: 300px;
        overflow-y: auto;
    }

    #settingsModal .custom-instruction-item {
        padding: 0.75rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: var(--border-style);
    }

        #settingsModal .custom-instruction-item:last-child {
            border-bottom: none;
        }

    #settingsModal .custom-instruction-info {
        flex: 1;
    }

    #settingsModal .custom-instruction-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
    }

    #settingsModal .custom-instruction-categories {
        font-size: 0.8rem;
        color: var(--text-color-secondary);
    }

    #settingsModal .custom-instruction-category {
        display: inline-block;
        padding: 0.125rem 0.375rem;
        background: var(--shadow);
        border-radius: 0.25rem;
        margin-right: 0.25rem;
        margin-bottom: 0.25rem;
        font-size: 0.7rem;
    }

    #settingsModal .custom-instruction-actions {
        display: flex;
        gap: 0.5rem;
    }

    #settingsModal .custom-instruction-action {
        background: transparent;
        border: none;
        cursor: pointer;
        padding: 0.25rem;
        font-size: 1rem;
        color: var(--text);
        opacity: 0.7;
        transition: opacity 0.2s;
    }

        #settingsModal .custom-instruction-action:hover {
            opacity: 1;
        }

        #settingsModal .custom-instruction-action.delete {
            color: var(--danger-color);
        }

/* 9. CUSTOM INSTRUCTION MODAL
   Styles for the add/edit custom instruction modal */

/* Custom Instruction Modal Size - High specificity */
body .modal#customInstructionModal .modal-dialog {
    max-width: 800px !important;
    width: 100% !important;
    margin: 1.75rem auto !important;
}

/* Large screens */
@media (min-width: 1600px) {
    body .modal#customInstructionModal .modal-dialog {
        max-width: 1000px !important;
        width: 100% !important;
    }
}

/* Medium screens */
@media (max-width: 992px) {
    body .modal#customInstructionModal .modal-dialog {
        max-width: 90% !important;
        width: 90% !important;
    }
}

/* Small screens */
@media (max-width: 768px) {
    body .modal#customInstructionModal .modal-dialog {
        max-width: 95% !important;
        width: 95% !important;
    }
}

/* Ensure the modal content expands properly */
body .modal#customInstructionModal .modal-content {
    min-height: 400px;
    width: 100% !important;
}

/* Ensure the dialog is centered */
body .modal#customInstructionModal.show {
    display: flex !important;
    align-items: center;
}

#customInstructionModal .modal-header {
    background-color: var(--background);
    border-bottom: 1px solid var(--border-color);
}

#customInstructionModal .modal-footer {
    background-color: var(--background);
    border-top: 1px solid var(--border-color);
}

#customInstructionModal .form-text {
    font-size: 0.8rem;
    color: var(--text-color-secondary);
}

#customInstructionModal .form-check {
    margin-right: 0.5rem;
}

#customInstructionModal .form-control,
#customInstructionModal textarea,
#customInstructionModal input[type="text"] {
    background-color: var(--background);
    color: var(--text);
    border: 1px solid var(--border-color);
}

#customInstructionModal .btn-group .btn-outline-primary {
    border: 1px solid var(--shadow);
    background: var(--shadow);
    color: var(--emphasis-text);
    padding: 0.25rem 0.5rem;
}

#customInstructionModal .btn-group .btn-check:checked + .btn-outline-primary {
    background: var(--emphasis);
    border-color: var(--emphasis);
    color: var(--button-foreground-hover);
}

#customInstructionModal .btn-group .btn-outline-primary:hover {
    background: color-mix(in srgb, var(--emphasis-soft) 70%, white);
    color: var(--emphasis-text);
}

/* MagicPrompt specific button styling to avoid conflicts */
#customInstructionModal .mp-button-primary {
    background-color: var(--emphasis);
    color: var(--button-foreground-hover);
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    #customInstructionModal .mp-button-primary:hover {
        opacity: 0.9;
    }

#customInstructionModal .mp-button-secondary {
    background-color: var(--background-gray);
    color: var(--text);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    #customInstructionModal .mp-button-secondary:hover {
        background-color: var(--shadow);
    }

#customInstructionModal #generateWithAIBtn {
    background-color: var(--emphasis);
    color: var(--button-foreground-hover);
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    #customInstructionModal #generateWithAIBtn:hover {
        opacity: 0.9;
    }

#customInstructionModal #regenerateInstructionBtn {
    color: var(--emphasis);
    border-color: var(--emphasis);
    background-color: transparent;
    border: 1px solid;
    border-radius: 4px;
    padding: 0.25rem 0.75rem;
}

    #customInstructionModal #regenerateInstructionBtn:hover {
        background-color: color-mix(in srgb, var(--emphasis) 10%, transparent);
    }

#customInstructionModal .ai-generation-status .spinner-border {
    color: var(--emphasis);
}

#customInstructionModal .ai-generation-status .progress-bar {
    background-color: var(--emphasis);
}

#customInstructionModal .ai-generation-status .progress {
    background-color: var(--background-gray);
}

#customInstructionModal #generatedInstructionContent {
    background-color: var(--background-gray);
}

#confirmDeleteModal .modal-content {
    background-color: var(--background);
    color: var(--text);
    border: 1px solid var(--border-color);
}

#confirmDeleteModal .modal-header {
    background-color: var(--background);
    border-bottom: 1px solid var(--border-color);
}

#confirmDeleteModal .modal-footer {
    background-color: var(--background);
    border-top: 1px solid var(--border-color);
    justify-content: space-between;
}

/* 10. TABBED INTERFACE FOR INSTRUCTIONS
   Styles for the tabbed interface in consolidated instructions section */

#instructionsTabNav {
    border-bottom: 1px solid var(--border-color);
    padding-left: 0.75rem;
    padding-right: 0.75rem;
}

    #instructionsTabNav .nav-link {
        color: var(--text);
        background-color: transparent;
        border: 1px solid transparent;
        border-bottom: none;
        margin-bottom: -1px;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
    }

        #instructionsTabNav .nav-link:hover {
            border-color: var(--shadow);
            background-color: var(--background-soft);
        }

        #instructionsTabNav .nav-link.active {
            color: var(--emphasis);
            background-color: var(--background);
            border-color: var(--border-color);
            border-bottom-color: transparent;
        }

#instructionsTabContent {
    padding: 0.75rem;
}

/* Instruction Type Radio Button Group - Fixed width and multi-row support */
.instruction-type-group {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    width: 100%;
}

.instruction-type-btn {
    display: inline-block;
    width: auto !important;
    flex: 0 0 auto !important;
    min-width: 0;
    border-radius: 4px !important;
    margin-right: 0.25rem;
    white-space: nowrap;
}

/* Remove duplicate controls in radio buttons */
#settingsModal #instructionTypeGroup .btn-outline-primary .custom-instruction-actions {
    display: none;
}

/* Feature Associations layout improvements */
#assign-tab-pane .row {
    margin-left: -0.5rem;
    margin-right: -0.5rem;
}

#assign-tab-pane .col-md-4,
#assign-tab-pane .col-md-6 {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
}

#assign-tab-pane .form-label {
    font-size: 0.85rem;
    margin-bottom: 0.25rem;
    color: var(--text);
}

#assign-tab-pane .form-select {
    font-size: 0.9rem;
    padding: 0.3rem 0.5rem;
    background-color: var(--background);
    color: var(--text);
    border: 1px solid var(--border-color);
}

/* Make the instruction form more compact */
#edit-tab-pane .form-label {
    margin-bottom: 0.25rem;
    color: var(--text);
}

#edit-tab-pane #instructionTextarea {
    min-height: 120px;
    resize: vertical;
    background-color: var(--background);
    color: var(--text);
    border: 1px solid var(--border-color);
}

/* Manage tab styling */
#manage-tab-pane .custom-instructions-list {
    max-height: 250px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background-color: var(--background);
}

/* MagicPrompt specific buttons for the manage tab */
#manage-tab-pane .mp-button {
    background-color: var(--emphasis);
    color: var(--button-foreground-hover);
    border: 1px solid var(--emphasis);
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    #manage-tab-pane .mp-button:hover {
        opacity: 0.9;
    }

/* 11. FOOTER SECTION */

#settingsModal .modal-footer {
    display: flex;
    justify-content: space-between;
    padding: var(--section-padding);
    border-top: var(--border-style);
}

    #settingsModal .modal-footer .save-buttons {
        display: flex;
        gap: 0.5rem;
    }

    #settingsModal .modal-footer .danger {
        margin-right: auto;
    }

/* 12. SPECIFIC BUTTON STYLING FOR MAGICPROMPT 
   These are unique to MagicPrompt and won't affect SwarmUI buttons */

.mp-save-close-btn {
    background-color: var(--emphasis);
    color: var(--button-foreground-hover);
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    .mp-save-close-btn:hover {
        opacity: 0.9;
    }

.mp-reset-btn {
    background-color: var(--danger-color);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    .mp-reset-btn:hover {
        opacity: 0.9;
    }

.mp-cancel-btn {
    background-color: var(--background-gray);
    color: var(--text);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    .mp-cancel-btn:hover {
        background-color: var(--shadow);
    }

.mp-save-instruction-btn {
    background-color: var(--emphasis);
    color: var(--button-foreground-hover);
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
}

    .mp-save-instruction-btn:hover {
        opacity: 0.9;
    }

/* AI Generation Fields Styling */
#aiGenerationFields .spinner-border {
    width: 1rem;
    height: 1rem;
    color: var(--emphasis);
}

#aiGenerationFields .progress {
    height: 0.5rem;
    background-color: var(--background-soft);
}

#aiGenerationFields .progress-bar {
    background-color: var(--emphasis);
}

#aiGenerationFields textarea {
    background-color: var(--background);
    color: var(--text);
    border: 1px solid var(--border-color);
}
